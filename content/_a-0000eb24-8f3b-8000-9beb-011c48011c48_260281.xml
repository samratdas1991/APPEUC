<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000eb24-8f3b-8000-9beb-011c48011c48_260287</versionUuid>
    <interface>
        <name>EAP_ParsingConfigContents_V2_SKB</name>
        <uuid>_a-0000eb24-8f3b-8000-9beb-011c48011c48_260281</uuid>
        <description>Rule to generate parsing config contents</description>
        <parentUuid>_a-0000e4c3-7a1b-8000-524f-1bef901bef90_6580</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>{
  #"_a-0000eab6-dc46-8000-9be9-011c48011c48_254941"(
    inputArray: ri!fileTypeConfig,
    selectedCard: ri!selectedFileType,
    fieldToShow: "file_config_name",
    fieldToSave: "in_file_type_config_id",
    selectedCardStyle: "ACCENT",
    unselectedCardStyle: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12981"[4],
    navigationIndex: ri!navigationIndex,
    isShowNavigationArrow: if(
      or(
        #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
          ri!fileTypeConfig
        ),
        tointeger(
          count(
            ri!fileTypeConfig
          )
        ) &lt; tointeger(
          5
        )
      ),
      false(),
      true()
    ),
    linkSaveInto: {
      /*Start File Entity Mapping Save Rule*/
      a!save(
        ri!fileEntityMapping,
        append(
          ri!fileEntityMapping,
          ri!selectedFileEntityMapping
        )
      ),
      a!save(
        ri!selectedFileEntityMapping,
        index(
          ri!fileEntityMapping,
          wherecontains(
            tointeger(
              ri!selectedFileType
            ),
            tointeger(
              index(
                ri!fileEntityMapping,
                "in_file_type_config_id",
                {}
              )
            )
          ),
          {}
        )
      ),
      a!save(
        ri!fileEntityMapping,
        remove(
          ri!fileEntityMapping,
          wherecontains(
            tointeger(
              ri!selectedFileType
            ),
            tointeger(
              index(
                ri!fileEntityMapping,
                "in_file_type_config_id",
                {}
              )
            )
          )
        )
      ),
      a!save(
        ri!selectedCard,
        index(
          union(
            touniformstring(
              #"SYSTEM_SYSRULES_forEach"(
                items: index(
                  ri!selectedFileEntityMapping,
                  wherecontains(
                    tointeger(
                      ri!selectedFileType
                    ),
                    tointeger(
                      index(
                        ri!selectedFileEntityMapping,
                        "in_file_type_config_id",
                        {}
                      )
                    )
                  ),
                  {}
                ),
                expression: if(
                  #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                    index(
                      fv!item,
                      "sheet_name",
                      {}
                    )
                  ),
                  index(
                    fv!item,
                    "sheet_index",
                    {}
                  ),
                  index(
                    fv!item,
                    "sheet_name",
                    {}
                  )
                )
              )
            ),
            touniformstring(
              #"SYSTEM_SYSRULES_forEach"(
                items: index(
                  ri!selectedFileEntityMapping,
                  wherecontains(
                    tointeger(
                      ri!selectedFileType
                    ),
                    tointeger(
                      index(
                        ri!selectedFileEntityMapping,
                        "in_file_type_config_id",
                        {}
                      )
                    )
                  ),
                  {}
                ),
                expression: if(
                  #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                    index(
                      fv!item,
                      "sheet_name",
                      {}
                    )
                  ),
                  index(
                    index(
                      ri!selectedFileEntityMapping,
                      wherecontains(
                        tointeger(
                          ri!selectedFileType
                        ),
                        tointeger(
                          index(
                            ri!selectedFileEntityMapping,
                            "in_file_type_config_id",
                            {}
                          )
                        )
                      ),
                      {}
                    ),
                    "sheet_index",
                    {}
                  ),
                  index(
                    index(
                      ri!fileEntityMapping,
                      wherecontains(
                        tointeger(
                          ri!selectedFileType
                        ),
                        tointeger(
                          index(
                            ri!fileEntityMapping,
                            "in_file_type_config_id",
                            {}
                          )
                        )
                      ),
                      {}
                    ),
                    "sheet_name",
                    {}
                  )
                )
              )
            )
          ),
          1,
          null
        )
      ),
      a!save(
        ri!selectedEntityCard,
        index(
          index(
            index(
              ri!selectedFileEntityMapping,
              wherecontains(
                tostring(
                  ri!selectedCard
                ),
                touniformstring(
                  #"SYSTEM_SYSRULES_forEach"(
                    items: ri!selectedFileEntityMapping,
                    expression: if(
                      #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                        index(
                          fv!item,
                          "sheet_name",
                          {}
                        )
                      ),
                      index(
                        fv!item,
                        "sheet_index",
                        {}
                      ),
                      index(
                        fv!item,
                        "sheet_name",
                        {}
                      )
                    )
                  )
                )
              ),
              {}
            ),
            1,
            {}
          ),
          "in_file_entity_mapping_id",
          {}
        ),
        /*tointeger(
          index(
            index(
              index(
                index(
                  ri!selectedFileEntityMapping,
                  wherecontains(
                    true(),
                    toboolean(
                      index(
                        ri!selectedFileEntityMapping,
                        "is_active",
                        {}
                      )
                    )
                  ),
                  {}
                ),
                wherecontains(
                  tostring(
                    ri!selectedCard
                  ),
                  touniformstring(
                    a!forEach(
                      items:index(
                        ri!selectedFileEntityMapping,
                        wherecontains(
                          true(),
                          toboolean(
                            index(
                              ri!selectedFileEntityMapping,
                              "is_active",
                              {}
                            )
                          )
                        ),
                        {}
                      ),
                      expression: if(
                        rule!EAP_Utils_CheckIsNull(
                          index(
                            fv!item,
                            "sheet_name",
                            {}
                          )
                        ),
                        index(
                          fv!item,
                          "sheet_index",
                          {}
                        ),
                        index(
                          fv!item,
                          "sheet_name",
                          {}
                        )
                      )
                    )
                    
                  )
                ),
                {}
              ),
              1,
              {}
            ),
            "in_file_entity_mapping_id",
            {}
          )
        )*/
        
      ),
      /*End File Entity Mapping Save Rule*/
      /*Start Unique Identifier Save Rule*/
      a!save(
        ri!uniqueIdentifiers.in_file_type_config_id,
        ri!selectedFileType
      ),
      a!save(
        ri!uniqueIdentifiers.in_file_entity_mapping_id,
        ri!selectedEntityCard
      ),
      a!save(
        ri!uniqueIdentifiers.selectedCard,
        ri!selectedCard
      ),
      a!save(
        ri!uniqueIdentifiers.selectedEntityCard,
        ri!selectedEntityCard
      ),
      a!save(
        ri!uniqueIdentifiers.in_file_entity_mapping_id,
        ri!selectedEntityCard
      ),
      a!save(
        ri!editConfig,
        false()
      ),
      a!save(
        ri!editDynamicConfig,
        false()
      ),
      /*End Unique Identifier Save Rule*/
      /*Start Sheet Field Mapping Save Rule*/
      a!save(
        ri!sheetFieldMapping,
        append(
          ri!sheetFieldMapping,
          ri!selectedSheetFieldMapping
        )
      ),
      a!save(
        ri!sheetFieldMapping,
        union(
          ri!sheetFieldMapping,
          ri!sheetFieldMapping
        )
      ),
      a!save(
        ri!selectedSheetFieldMapping,
        index(
          ri!sheetFieldMapping,
          wherecontains(
            tointeger(
              ri!selectedEntityCard
            ),
            tointeger(
              index(
                ri!sheetFieldMapping,
                "in_file_entity_mapping_id",
                {}
              )
            )
          ),
          {}
        )
      ),
      a!save(
        ri!sheetFieldMapping,
        remove(
          ri!sheetFieldMapping,
          wherecontains(
            tointeger(
              ri!selectedEntityCard
            ),
            tointeger(
              index(
                ri!sheetFieldMapping,
                "in_file_entity_mapping_id",
                {}
              )
            )
          )
        )
      ),
      /*End Sheet Field Mapping Save Rule*/
      /*Start Fixed Cell Mapping Save Rule*/
      a!save(
        ri!sheetFixedCellsConfig,
        append(
          ri!sheetFixedCellsConfig,
          ri!selectedSheetFixedCellsConfig
        )
      ),
      a!save(
        ri!sheetFixedCellsConfig,
        union(
          ri!sheetFixedCellsConfig,
          ri!sheetFixedCellsConfig
        )
      ),
      a!save(
        ri!selectedSheetFixedCellsConfig,
        index(
          ri!sheetFixedCellsConfig,
          wherecontains(
            tointeger(
              ri!selectedEntityCard
            ),
            tointeger(
              index(
                ri!sheetFixedCellsConfig,
                "in_file_entity_mapping_id",
                {}
              )
            )
          ),
          {}
        )
      ),
      a!save(
        ri!sheetFixedCellsConfig,
        remove(
          ri!sheetFixedCellsConfig,
          wherecontains(
            tointeger(
              ri!selectedEntityCard
            ),
            tointeger(
              index(
                ri!sheetFixedCellsConfig,
                "in_file_entity_mapping_id",
                {}
              )
            )
          )
        )
      ),
      /*End Fixed Cell Mapping Save Rule*/
      /*Start Transpose Config Save Rule*/
      a!save(
        ri!refProcessSheetTransposeConfig,
        append(
          ri!refProcessSheetTransposeConfig,
          ri!selectedRefProcessSheetTransposeConfig
        )
      ),
      a!save(
        ri!refProcessSheetTransposeConfig,
        union(
          ri!refProcessSheetTransposeConfig,
          ri!refProcessSheetTransposeConfig
        )
      ),
      a!save(
        ri!selectedRefProcessSheetTransposeConfig,
        index(
          ri!refProcessSheetTransposeConfig,
          wherecontains(
            tointeger(
              ri!selectedEntityCard
            ),
            tointeger(
              index(
                ri!refProcessSheetTransposeConfig,
                "in_file_entity_mapping_id",
                {}
              )
            )
          ),
          {}
        )
      ),
      a!save(
        ri!refProcessSheetTransposeConfig,
        remove(
          ri!refProcessSheetTransposeConfig,
          wherecontains(
            tointeger(
              ri!selectedEntityCard
            ),
            tointeger(
              index(
                ri!refProcessSheetTransposeConfig,
                "in_file_entity_mapping_id",
                {}
              )
            )
          )
        )
      ),
      /*End Transpose Config Save Rule*/
      /*Milestone*/
      a!save(
        ri!activeStep,
        1
      )/*a!save(*/
      /*ri!isFileTabClicked,*/
      /*toboolean(true())*/
      /*)*/
      
    },
    isValidate: true(),
    buttonAction: ri!ButtonAction
  ),
  #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_11158"(
    showBorder: false(),
    contents: {
      /*if the selected file type is parsable then show the config*/
     if(
      and(
        contains(
         touniformstring({#"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12255"(
           MasterLookup: #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_124946"(
             masterLookUpData: ri!masterLookUpData,
             categoryGroup: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3238117"[4] 
           ),
           UniqueKey: #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_108148"[31],
           Column: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_16271"[3]
         )}),
         tostring(index(
           index(
             ri!fileTypeConfig,
             wherecontains(
               tointeger(ri!selectedFileType),
               tointeger(index(
                 ri!fileTypeConfig,"in_file_type_config_id",{}
               )
               )
             ),
             {}
           ),
           "file_type",{}))
       ),
       or(index(
         index(
           ri!fileTypeConfig,
           wherecontains(
             tointeger(ri!selectedFileType),
             tointeger(index(
               ri!fileTypeConfig,"in_file_type_config_id",{}
             )
             )
           ),
           {}
         ),
         "is_parsing_reqd",{})
         )
       ),
       {
         #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_10573"(
           steps: ri!steps,
           activeStep: ri!activeStep,
           selectedStep: ri!selectedStep,
           isHideNextStepsLink: if(
             ri!isReadOnly,
             false(),
             true()
           )
         ),
         choose(
           ri!activeStep,
           {
             #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_10844"(
               editDynamicConfig:ri!editDynamicConfig,
               fileEntityMapping: ri!selectedFileEntityMapping,
               masterLookUpData: ri!masterLookUpData,
               isReadOnly: ri!isReadOnly,
               fileTypeConfig: ri!fileTypeConfig,
               uniqueIdentifiers: ri!uniqueIdentifiers,
               entityData: ri!entityData,
               parserTypes: ri!parserTypes,
               selectedFileType: ri!selectedFileType,
               dynamicConfig:ri!dynamicConfig,
               dynamicConfigDetails: ri!dynamicConfigDetails,
               editConfig:ri!editConfig,
               buttonAction:ri!ButtonAction
             )
           },
           {
             #"SYSTEM_SYSRULES_columnsLayout"(
               columns: {
                 #"SYSTEM_SYSRULES_columnLayout"(
                   contents: {
                     #"SYSTEM_SYSRULES_forEach"(
                       items: #"SYSTEM_SYSRULES_forEach"(
                         items: union(
                           #"SYSTEM_SYSRULES_forEach"(
                             items: index(
                               ri!selectedFileEntityMapping,
                               wherecontains(
                                 true(),
                                 toboolean(
                                   index(
                                     ri!selectedFileEntityMapping,
                                     "is_active",
                                     {}
                                   )
                                 )
                               ),
                               {}
                             ),
                             expression: if(
                               #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                                 index(
                                   fv!item,
                                   "sheet_name",
                                   {}
                                 )
                               ),
                               index(
                                 fv!item,
                                 "sheet_index",
                                 null
                               ),
                               index(
                                 fv!item,
                                 "sheet_name",
                                 null
                               )
                             )
                           ),
                           #"SYSTEM_SYSRULES_forEach"(
                             items: index(
                               ri!selectedFileEntityMapping,
                               wherecontains(
                                 true(),
                                 toboolean(
                                   index(
                                     ri!selectedFileEntityMapping,
                                     "is_active",
                                     {}
                                   )
                                 )
                               ),
                               {}
                             ),
                             expression: if(
                               #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                                 index(
                                   fv!item,
                                   "sheet_name",
                                   {}
                                 )
                               ),
                               index(
                                 fv!item,
                                 "sheet_index",
                                 null
                               ),
                               index(
                                 fv!item,
                                 "sheet_name",
                                 null
                               )
                             )
                           )
                         ),
                         expression: {
                           fieldToShow: fv!item,
                           fieldToSave: fv!item
                         }
                       ),
                       expression: {
                         #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_10595"(
                           input: fv!item,
                           selectedCard: ri!selectedCard,
                           fieldToShow: "fieldToShow",
                           fieldToSave: "fieldToSave",
                           selectedCardStyle: "ACCENT",
                           unselectedCardStyle: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12981"[8],
                           linkSaveInto: {
                             a!save(
                               ri!selectedEntityCard,
                               index(
                                 index(
                                   index(
                                     ri!selectedFileEntityMapping,
                                     wherecontains(
                                       tostring(
                                         ri!selectedCard
                                       ),
                                       touniformstring(
                                         #"SYSTEM_SYSRULES_forEach"(
                                           items: ri!selectedFileEntityMapping,
                                           expression: if(
                                             #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                                               index(
                                                 fv!item,
                                                 "sheet_name",
                                                 {}
                                               )
                                             ),
                                             index(
                                               fv!item,
                                               "sheet_index",
                                               {}
                                             ),
                                             index(
                                               fv!item,
                                               "sheet_name",
                                               {}
                                             )
                                           )
                                         )
                                       )
                                     ),
                                     {}
                                   ),
                                   1,
                                   {}
                                 ),
                                 "in_file_entity_mapping_id",
                                 {}
                               ),
                             ),
                             a!save(
                               ri!uniqueIdentifiers.in_file_entity_mapping_id,
                               ri!selectedEntityCard
                             ),
                             a!save(
                               ri!sheetFieldMapping,
                               append(
                                 ri!sheetFieldMapping,
                                 ri!selectedSheetFieldMapping
                               )
                             ),
                             a!save(
                               ri!sheetFieldMapping,
                               union(
                                 ri!sheetFieldMapping,
                                 ri!sheetFieldMapping
                               )
                             ),
                             if(
                               and(
                                 tointeger(
                                   index(
                                     index(
                                       ri!selectedFileEntityMapping,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!selectedFileEntityMapping,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     ),
                                     "parser_type_id",
                                     {}
                                   )
                                 ) = tointeger(
                                   index(
                                     index(
                                       ri!parserTypes,
                                       wherecontains(
                                         tostring(
                                           #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233177"[1]
                                         ),
                                         touniformstring(
                                           index(
                                             ri!parserTypes,
                                             "parser_name",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     ),
                                     "parser_type_id",
                                     {}
                                   )
                                 )
                               ),
                               if(
                                 or(
                                   #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                                     index(
                                       ri!sheetFieldMapping,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!sheetFieldMapping,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   )
                                 ),
                                 {
                                   /*Default rows will be generating by button*/
                                   a!save(
                                     ri!selectedSheetFieldMapping,
                                     index(
                                       ri!sheetFieldMapping,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!sheetFieldMapping,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   ),

                                 },
                                 {
                                   a!save(
                                     ri!selectedSheetFieldMapping,
                                     index(
                                       ri!sheetFieldMapping,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!sheetFieldMapping,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFieldMapping,
                                     remove(
                                       ri!sheetFieldMapping,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!sheetFieldMapping,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       )
                                     )
                                   ),

                                 }
                               ),
                               {}
                             ),
                             a!save(
                               ri!sheetFixedCellsConfig,
                               append(
                                 ri!sheetFixedCellsConfig,
                                 ri!selectedSheetFixedCellsConfig
                               )
                             ),
                             a!save(
                               ri!sheetFixedCellsConfig,
                               union(
                                 ri!sheetFixedCellsConfig,
                                 ri!sheetFixedCellsConfig
                               )
                             ),
                             if(
                               and(
                                 or(
                                   toboolean(
                                     index(
                                       index(
                                         ri!selectedFileEntityMapping,
                                         wherecontains(
                                           tointeger(
                                             ri!selectedEntityCard
                                           ),
                                           tointeger(
                                             index(
                                               ri!selectedFileEntityMapping,
                                               "in_file_entity_mapping_id",
                                               {}
                                             )
                                           )
                                         ),
                                         {}
                                       ),
                                       "include_fixed_copy",
                                       {}
                                     )
                                   )
                                 )
                               ),
                               if(
                                 or(
                                   #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                                     index(
                                       ri!sheetFixedCellsConfig,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!sheetFixedCellsConfig,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   )
                                 ),
                                 {
                                   a!save(
                                     ri!selectedSheetFixedCellsConfig,
                                     index(
                                       ri!sheetFixedCellsConfig,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!sheetFixedCellsConfig,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   ),
                                 },
                                 {
                                   a!save(
                                     ri!selectedSheetFixedCellsConfig,
                                     index(
                                       ri!sheetFixedCellsConfig,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!sheetFixedCellsConfig,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFixedCellsConfig,
                                     remove(
                                       ri!sheetFixedCellsConfig,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!sheetFixedCellsConfig,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       )
                                     )
                                   )
                                 }
                               ),
                               {}
                             ),
                             a!save(
                               ri!refProcessSheetTransposeConfig,
                               append(
                                 ri!refProcessSheetTransposeConfig,
                                 ri!selectedRefProcessSheetTransposeConfig
                               )
                             ),
                             a!save(
                               ri!refProcessSheetTransposeConfig,
                               union(
                                 ri!refProcessSheetTransposeConfig,
                                 ri!refProcessSheetTransposeConfig
                               )
                             ),
                             if(
                               and(
                                 or(
                                   tointeger(
                                     index(
                                       index(
                                         ri!selectedFileEntityMapping,
                                         wherecontains(
                                           tointeger(
                                             ri!selectedEntityCard
                                           ),
                                           tointeger(
                                             index(
                                               ri!selectedFileEntityMapping,
                                               "in_file_entity_mapping_id",
                                               {}
                                             )
                                           )
                                         ),
                                         {}
                                       ),
                                       "parser_type_id",
                                       {}
                                     )
                                   ) = tointeger(
                                     index(
                                       index(
                                         ri!parserTypes,
                                         wherecontains(
                                           tostring(
                                             #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233177"[2]
                                           ),
                                           touniformstring(
                                             index(
                                               ri!parserTypes,
                                               "parser_name",
                                               {}
                                             )
                                           )
                                         ),
                                         {}
                                       ),
                                       "parser_type_id",
                                       {}
                                     )
                                   )
                                 )
                               ),
                               if(
                                 or(
                                   #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                                     index(
                                       ri!refProcessSheetTransposeConfig,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!refProcessSheetTransposeConfig,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   )
                                 ),
                                 {
                                   a!save(
                                     ri!selectedRefProcessSheetTransposeConfig,
                                     index(
                                       ri!refProcessSheetTransposeConfig,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!refProcessSheetTransposeConfig,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   ),
                                 },
                                 {
                                   a!save(
                                     ri!selectedRefProcessSheetTransposeConfig,
                                     index(
                                       ri!refProcessSheetTransposeConfig,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!refProcessSheetTransposeConfig,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       ),
                                       {}
                                     )
                                   ),
                                   a!save(
                                     ri!refProcessSheetTransposeConfig,
                                     remove(
                                       ri!refProcessSheetTransposeConfig,
                                       wherecontains(
                                         tointeger(
                                           ri!selectedEntityCard
                                         ),
                                         tointeger(
                                           index(
                                             ri!refProcessSheetTransposeConfig,
                                             "in_file_entity_mapping_id",
                                             {}
                                           )
                                         )
                                       )
                                     )
                                   )
                                 }
                               ),
                               {}
                             ),

                           },
                           isValidate: true(),
                           buttonAction: ri!ButtonAction
                         ),
                         #"SYSTEM_SYSRULES_sectionLayout_v1"()
                       }
                     )
                   },
                   width: "NARROW"
                 ),
                 #"SYSTEM_SYSRULES_columnLayout"(
                   width: "",
                   contents: {
                     #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_10589"(
                       inputArray: #"SYSTEM_SYSRULES_forEach"(
                         items: index(
                           ri!selectedFileEntityMapping,
                           wherecontains(
                             tostring(
                               ri!selectedCard
                             ),
                             touniformstring(
                               #"SYSTEM_SYSRULES_forEach"(
                                 items: ri!selectedFileEntityMapping,
                                 expression: if(
                                   #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                                     index(
                                       fv!item,
                                       "sheet_name",
                                       {}
                                     )
                                   ),
                                   index(
                                     fv!item,
                                     "sheet_index",
                                     {}
                                   ),
                                   index(
                                     fv!item,
                                     "sheet_name",
                                     {}
                                   )
                                 )
                               )
                             )
                           ),
                           {}
                         ),
                         expression: {
                           entity_name: concat(
                             index(
                               fv!item,
                               "entity_name",
                               null
                             ),
                             " - ",
                             "Seq ",
                             index(
                               fv!item,
                               "sequence_order",
                               null
                             )
                           ),
                           in_file_entity_mapping_id: index(
                             fv!item,
                             "in_file_entity_mapping_id",
                             null
                           )
                         }
                       ),
                       selectedCard: ri!selectedEntityCard,
                       fieldToShow: "entity_name",
                       fieldToSave: "in_file_entity_mapping_id",
                       selectedCardStyle: "ACCENT",
                       unselectedCardStyle: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12981"[8],
                       linkSaveInto: {
                         a!save(
                           ri!uniqueIdentifiers.in_file_entity_mapping_id,
                           ri!selectedEntityCard
                         ),
                         a!save(
                           ri!sheetFieldMapping,
                           append(
                             ri!sheetFieldMapping,
                             ri!selectedSheetFieldMapping
                           )
                         ),
                         a!save(
                           ri!sheetFieldMapping,
                           union(
                             ri!sheetFieldMapping,
                             ri!sheetFieldMapping
                           )
                         ),
                         if(
                           and(
                             #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                               index(
                                 ri!sheetFieldMapping,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!sheetFieldMapping,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             ),
                             tointeger(
                               index(
                                 index(
                                   ri!selectedFileEntityMapping,
                                   wherecontains(
                                     tostring(
                                       ri!selectedEntityCard
                                     ),
                                     touniformstring(
                                       index(
                                         ri!selectedFileEntityMapping,
                                         "in_file_entity_mapping_id",
                                         {}
                                       )
                                     )
                                   ),
                                   {}
                                 ),
                                 "parser_type_id",
                                 {}
                               )
                             ) = tointeger(
                               index(
                                 index(
                                   ri!parserTypes,
                                   wherecontains(
                                     tostring(
                                       #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233177"[1]
                                     ),
                                     touniformstring(
                                       index(
                                         ri!parserTypes,
                                         "parser_name",
                                         {}
                                       )
                                     )
                                   ),
                                   {}
                                 ),
                                 "parser_type_id",
                                 {}
                               )
                             )
                           ),
                           {
                             a!save(
                               ri!selectedSheetFieldMapping,
                               index(
                                 ri!sheetFieldMapping,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!sheetFieldMapping,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             )
                           },
                           {
                             a!save(
                               ri!selectedSheetFieldMapping,
                               index(
                                 ri!sheetFieldMapping,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!sheetFieldMapping,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             )
                           }
                         ),
                         a!save(
                           ri!sheetFieldMapping,
                           remove(
                             ri!sheetFieldMapping,
                             wherecontains(
                               tointeger(
                                 ri!selectedEntityCard
                               ),
                               tointeger(
                                 index(
                                   ri!sheetFieldMapping,
                                   "in_file_entity_mapping_id",
                                   {}
                                 )
                               )
                             )
                           )
                         ),
                         a!save(
                           ri!sheetFixedCellsConfig,
                           append(
                             ri!sheetFixedCellsConfig,
                             ri!selectedSheetFixedCellsConfig
                           )
                         ),
                         a!save(
                           ri!sheetFixedCellsConfig,
                           union(
                             ri!sheetFixedCellsConfig,
                             ri!sheetFixedCellsConfig
                           )
                         ),
                         If(
                           and(
                             #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                               index(
                                 ri!sheetFixedCellsConfig,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!sheetFixedCellsConfig,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             ),
                             or(
                               tostring(
                                 index(
                                   index(
                                     ri!selectedFileEntityMapping,
                                     wherecontains(
                                       tostring(
                                         ri!selectedEntityCard
                                       ),
                                       touniformstring(
                                         index(
                                           ri!selectedFileEntityMapping,
                                           "in_file_entity_mapping_id",
                                           {}
                                         )
                                       )
                                     ),
                                     {}
                                   ),
                                   "include_fixed_copy",
                                   {}
                                 )
                               )
                             )
                           ),
                           {
                             a!save(
                               ri!selectedSheetFixedCellsConfig,
                               index(
                                 ri!sheetFixedCellsConfig,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!sheetFixedCellsConfig,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             )
                           },
                           {
                             a!save(
                               ri!selectedSheetFixedCellsConfig,
                               index(
                                 ri!sheetFixedCellsConfig,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!sheetFixedCellsConfig,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             )
                           }
                         ),
                         a!save(
                           ri!sheetFixedCellsConfig,
                           remove(
                             ri!sheetFixedCellsConfig,
                             wherecontains(
                               tointeger(
                                 ri!selectedEntityCard
                               ),
                               tointeger(
                                 index(
                                   ri!sheetFixedCellsConfig,
                                   "in_file_entity_mapping_id",
                                   {}
                                 )
                               )
                             )
                           )
                         ),
                         a!save(
                           ri!refProcessSheetTransposeConfig,
                           append(
                             ri!refProcessSheetTransposeConfig,
                             ri!selectedRefProcessSheetTransposeConfig
                           )
                         ),
                         a!save(
                           ri!refProcessSheetTransposeConfig,
                           union(
                             ri!refProcessSheetTransposeConfig,
                             ri!refProcessSheetTransposeConfig
                           )
                         ),
                         if(
                           and(
                             #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                               index(
                                 ri!refProcessSheetTransposeConfig,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!refProcessSheetTransposeConfig,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             ),
                             tointeger(
                               index(
                                 index(
                                   ri!selectedFileEntityMapping,
                                   wherecontains(
                                     tostring(
                                       ri!selectedEntityCard
                                     ),
                                     touniformstring(
                                       index(
                                         ri!selectedFileEntityMapping,
                                         "in_file_entity_mapping_id",
                                         {}
                                       )
                                     )
                                   ),
                                   {}
                                 ),
                                 "parser_type_id",
                                 {}
                               )
                             ) = tointeger(
                               index(
                                 index(
                                   ri!parserTypes,
                                   wherecontains(
                                     tostring(
                                       #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233177"[2]
                                     ),
                                     touniformstring(
                                       index(
                                         ri!parserTypes,
                                         "parser_name",
                                         {}
                                       )
                                     )
                                   ),
                                   {}
                                 ),
                                 "parser_type_id",
                                 {}
                               )
                             )
                           ),
                           {
                             a!save(
                               ri!selectedRefProcessSheetTransposeConfig,
                               index(
                                 ri!refProcessSheetTransposeConfig,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!refProcessSheetTransposeConfig,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             )
                           },
                           {
                             a!save(
                               ri!selectedRefProcessSheetTransposeConfig,
                               index(
                                 ri!refProcessSheetTransposeConfig,
                                 wherecontains(
                                   tointeger(
                                     ri!selectedEntityCard
                                   ),
                                   tointeger(
                                     index(
                                       ri!refProcessSheetTransposeConfig,
                                       "in_file_entity_mapping_id",
                                       {}
                                     )
                                   )
                                 ),
                                 {}
                               )
                             )
                           }
                         ),
                         a!save(
                           ri!refProcessSheetTransposeConfig,
                           remove(
                             ri!refProcessSheetTransposeConfig,
                             wherecontains(
                               tointeger(
                                 ri!selectedEntityCard
                               ),
                               tointeger(
                                 index(
                                   ri!refProcessSheetTransposeConfig,
                                   "in_file_entity_mapping_id",
                                   {}
                                 )
                               )
                             )
                           )
                         )
                       },
                       isValidate: true(),
                       buttonAction: ri!ButtonAction
                     ),
                     #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_11158"(
                       contents: {
                         if(
                           or(
                             tointeger(
                               index(
                                 index(
                                   ri!selectedFileEntityMapping,
                                   wherecontains(
                                     tostring(
                                       ri!selectedEntityCard
                                     ),
                                     touniformstring(
                                       index(
                                         ri!selectedFileEntityMapping,
                                         "in_file_entity_mapping_id",
                                         {}
                                       )
                                     )
                                   ),
                                   {}
                                 ),
                                 "parser_type_id",
                                 {}
                               )
                             ) = tointeger(
                               index(
                                 index(
                                   ri!parserTypes,
                                   wherecontains(
                                     tostring(
                                       #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233177"[1]
                                     ),
                                     touniformstring(
                                       index(
                                         ri!parserTypes,
                                         "parser_name",
                                         {}
                                       )
                                     )
                                   ),
                                   {}
                                 ),
                                 "parser_type_id",
                                 {}
                               )
                             ),
                             tostring(
                               index(
                                 index(
                                   ri!selectedFileEntityMapping,
                                   wherecontains(
                                     tostring(
                                       ri!selectedEntityCard
                                     ),
                                     touniformstring(
                                       index(
                                         ri!selectedFileEntityMapping,
                                         "in_file_entity_mapping_id",
                                         {}
                                       )
                                     )
                                   ),
                                   {}
                                 ),
                                 "parser_type",
                                 {}
                               )
                             ) = tostring(
                               #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233177"[1]
                             )
                           ),
                           /*Sheet Entity Mapping*/
                           #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_10500"(
                             sheetFieldMapping: ri!selectedSheetFieldMapping,
                             masterLookUpData: ri!masterLookUpData,
                             isReadOnly: ri!isReadOnly,
                             fileTypeConfig: ri!fileTypeConfig,
                             uniqueIdentifiers: ri!uniqueIdentifiers,
                             fileEntityMapping: ri!selectedFileEntityMapping,
                             runtimeConfigs: ri!runtimeConfigs,
                             columns:ri!columns,
                             allTableColumns:ri!allTableColumns
                           ),
                           /*Transpose Config*/
                           if(
                             or(
                               tointeger(
                                 index(
                                   index(
                                     ri!selectedFileEntityMapping,
                                     wherecontains(
                                       tostring(
                                         ri!selectedEntityCard
                                       ),
                                       touniformstring(
                                         index(
                                           ri!selectedFileEntityMapping,
                                           "in_file_entity_mapping_id",
                                           {}
                                         )
                                       )
                                     ),
                                     {}
                                   ),
                                   "parser_type_id",
                                   {}
                                 )
                               ) = tointeger(
                                 index(
                                   index(
                                     ri!parserTypes,
                                     wherecontains(
                                       tostring(
                                         #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233177"[2]
                                       ),
                                       touniformstring(
                                         index(
                                           ri!parserTypes,
                                           "parser_name",
                                           {}
                                         )
                                       )
                                     ),
                                     {}
                                   ),
                                   "parser_type_id",
                                   {}
                                 )
                               ),
                               tostring(
                                 index(
                                   index(
                                     ri!selectedFileEntityMapping,
                                     wherecontains(
                                       tostring(
                                         ri!selectedEntityCard
                                       ),
                                       touniformstring(
                                         index(
                                           ri!selectedFileEntityMapping,
                                           "in_file_entity_mapping_id",
                                           {}
                                         )
                                       )
                                     ),
                                     {}
                                   ),
                                   "parser_type",
                                   {}
                                 )
                               ) = tostring(
                                 #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233177"[2]
                               )
                             ),
                             #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_10170"(
                               refProcessSheetTransposeConfig: ri!selectedRefProcessSheetTransposeConfig,
                               masterLookUpData: ri!masterLookUpData,
                               isReadOnly: ri!isReadOnly,
                               uniqueIdentifiers: ri!uniqueIdentifiers,
                               sheetFieldMapping: ri!sheetFieldMapping,
                               fileEntityMapping: ri!selectedFileEntityMapping,
                               allTableColumns:ri!allTableColumns,
                               columns:ri!columns
                             ),
                             {}
                           )
                         ),
                         /*Fixed Cell Config*/
                         if(
                           or(
                             tostring(
                               index(
                                 index(
                                   ri!selectedFileEntityMapping,
                                   wherecontains(
                                     tostring(
                                       ri!selectedEntityCard
                                     ),
                                     touniformstring(
                                       index(
                                         ri!selectedFileEntityMapping,
                                         "in_file_entity_mapping_id",
                                         {}
                                       )
                                     )
                                   ),
                                   {}
                                 ),
                                 "include_fixed_copy",
                                 {}
                               )
                             )
                           ),
                           {
                             #"SYSTEM_SYSRULES_richTextDisplayField"(),
                             #"SYSTEM_SYSRULES_columnsLayout"(
                               columns: {
                                 #"SYSTEM_SYSRULES_columnLayout"(
                                   contents: {
                                     #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_10182"(
                                       sheetFixedCellsConfig: ri!selectedSheetFixedCellsConfig,
                                       masterLookUpData: ri!masterLookUpData,
                                       isReadOnly: ri!isReadOnly,
                                       uniqueIdentifiers: ri!uniqueIdentifiers,
                                       sheetFieldMapping: ri!sheetFieldMapping,
                                       fileEntityMapping: ri!selectedFileEntityMapping
                                     )
                                   }
                                 ),
                                 /*a!columnLayout()*/

                               }
                             )
                           },
                           {}
                         ),
                         if(
                           ri!isReadOnly,
                           {},
                           /*Entity Buttons*/
                           #"SYSTEM_SYSRULES_ButtonLayout"(
                             primaryButtons: {
                               #"SYSTEM_SYSRULES_ButtonWidget"(
                                 label: "Save",
                                 saveInto: {
                                   a!save(
                                     ri!entityActiveStep,
                                     ri!entityActiveStep + 1
                                   ),
                                   a!save(
                                     ri!fileEntityMapping,
                                     append(
                                       ri!fileEntityMapping,
                                       ri!selectedFileEntityMapping
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFieldMapping,
                                     append(
                                       ri!sheetFieldMapping,
                                       ri!selectedSheetFieldMapping
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFieldMapping,
                                     union(
                                       ri!sheetFieldMapping,
                                       ri!sheetFieldMapping
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFixedCellsConfig,
                                     append(
                                       ri!sheetFixedCellsConfig,
                                       ri!selectedSheetFixedCellsConfig
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFixedCellsConfig,
                                     union(
                                       ri!sheetFixedCellsConfig,
                                       ri!sheetFixedCellsConfig
                                     )
                                   ),
                                   a!save(
                                     ri!refProcessSheetTransposeConfig,
                                     append(
                                       ri!refProcessSheetTransposeConfig,
                                       ri!selectedRefProcessSheetTransposeConfig
                                     )
                                   ),
                                   a!save(
                                     ri!refProcessSheetTransposeConfig,
                                     union(
                                       ri!refProcessSheetTransposeConfig,
                                       ri!refProcessSheetTransposeConfig
                                     )
                                   ),
                                   a!save(
                                     ri!selectedFileEntityMapping,
                                     null
                                   ),
                                   a!save(
                                     ri!selectedSheetFieldMapping,
                                     null
                                   ),
                                   a!save(
                                     ri!selectedSheetFixedCellsConfig,
                                     null
                                   ),
                                   a!save(
                                     ri!selectedRefProcessSheetTransposeConfig,
                                     null
                                   )
                                 },
                                 size: "SMALL",
                                 style: "STANDARD",
                                 showWhen: ri!entityActiveStep &lt;&gt; length(
                                   ri!entitySteps
                                 ),
                                 submit: true(),
                                 validate: true()
                               ),
                               #"SYSTEM_SYSRULES_ButtonWidget"(
                                 label: "Save",
                                 submit: true,
                                 size: "SMALL",
                                 saveInto: {
                                   a!save(
                                     ri!fileEntityMapping,
                                     append(
                                       ri!fileEntityMapping,
                                       ri!selectedFileEntityMapping
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFieldMapping,
                                     append(
                                       ri!sheetFieldMapping,
                                       ri!selectedSheetFieldMapping
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFieldMapping,
                                     union(
                                       ri!sheetFieldMapping,
                                       ri!sheetFieldMapping
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFixedCellsConfig,
                                     append(
                                       ri!sheetFixedCellsConfig,
                                       ri!selectedSheetFixedCellsConfig
                                     )
                                   ),
                                   a!save(
                                     ri!sheetFixedCellsConfig,
                                     union(
                                       ri!sheetFixedCellsConfig,
                                       ri!sheetFixedCellsConfig
                                     )
                                   ),
                                   a!save(
                                     ri!refProcessSheetTransposeConfig,
                                     append(
                                       ri!refProcessSheetTransposeConfig,
                                       ri!selectedRefProcessSheetTransposeConfig
                                     )
                                   ),
                                   a!save(
                                     ri!refProcessSheetTransposeConfig,
                                     union(
                                       ri!refProcessSheetTransposeConfig,
                                       ri!refProcessSheetTransposeConfig
                                     )
                                   ),
                                   a!save(
                                     ri!selectedFileEntityMapping,
                                     null
                                   ),
                                   a!save(
                                     ri!selectedFileEntityMapping,
                                     null
                                   ),
                                   a!save(
                                     ri!selectedSheetFieldMapping,
                                     null
                                   ),
                                   a!save(
                                     ri!selectedSheetFixedCellsConfig,
                                     null
                                   ),
                                   a!save(
                                     ri!selectedRefProcessSheetTransposeConfig,
                                     null
                                   )
                                 },
                                 style: "STANDARD",
                                 showWhen: ri!entityActiveStep = length(
                                   ri!entitySteps
                                 )
                               )
                             },
                             secondaryButtons: {}
                           )
                         )
                       },
                       showBorder: false(),
                     )
                   }
                 )
               }
             )
           }
         ) 
       },
       {
         #"SYSTEM_SYSRULES_columnsLayout"(),
         #"SYSTEM_SYSRULES_columnsLayout"(),
         #"SYSTEM_SYSRULES_columnsLayout"(
           columns:{
             #"SYSTEM_SYSRULES_columnLayout"(
               contents: {}
             ),
             #"SYSTEM_SYSRULES_columnLayout"(
               contents: {
                 #"SYSTEM_SYSRULES_richTextDisplayField"(
                   value: #"SYSTEM_SYSRULES_richTextItem_v1"(
                     text: concat(
                       "There are no configurations required for this file type: ",
                       index(
                         index(
                           ri!fileTypeConfig,
                           wherecontains(
                             tointeger(ri!selectedFileType),
                             tointeger(index(
                               ri!fileTypeConfig,"in_file_type_config_id",{}
                             )
                             )
                           ),
                           {}
                         ),
                         "file_type",{})
                     ),
                     style: "EMPHASIS",
                     color: "ACCENT"
                   )
                 )
               }
             ),
             #"SYSTEM_SYSRULES_columnLayout"(
               contents: {}
             )
           }
         )
       }
     )
      ,
      if(
        or(
          ri!isReadOnly,
          ri!editDynamicConfig
        ),
        {},
        /*Buttons*/
        #"SYSTEM_SYSRULES_ButtonLayout"(
          primaryButtons: {
            #"SYSTEM_SYSRULES_ButtonWidget"(
              label: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[4],
              submit: true(),
              value: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[4],
              saveInto: {
                /*if(*/
                  /*or(*/
                    /*ri!activeStep &gt; 1*/
                  /*),*/
                  /*{},*/
                  /*a!save(*/
                    /*ri!activeStep,*/
                    /*ri!activeStep + 1*/
                  /*)*/
                /*),*/
                ri!ButtonAction,
                a!save(
                  ri!fileEntityMapping,
                  append(
                    ri!fileEntityMapping,
                    ri!selectedFileEntityMapping
                  )
                ),
                a!save(
                  ri!sheetFieldMapping,
                  append(
                    ri!sheetFieldMapping,
                    ri!selectedSheetFieldMapping
                  )
                ),
                a!save(
                  ri!sheetFieldMapping,
                  union(
                    ri!sheetFieldMapping,
                    ri!sheetFieldMapping
                  )
                ),
                a!save(
                  ri!sheetFixedCellsConfig,
                  append(
                    ri!sheetFixedCellsConfig,
                    ri!selectedSheetFixedCellsConfig
                  )
                ),
                a!save(
                  ri!sheetFixedCellsConfig,
                  union(
                    ri!sheetFixedCellsConfig,
                    ri!sheetFixedCellsConfig
                  )
                ),
                a!save(
                  ri!refProcessSheetTransposeConfig,
                  append(
                    ri!refProcessSheetTransposeConfig,
                    ri!selectedRefProcessSheetTransposeConfig
                  )
                ),
                a!save(
                  ri!refProcessSheetTransposeConfig,
                  union(
                    ri!refProcessSheetTransposeConfig,
                    ri!refProcessSheetTransposeConfig
                  )
                ),
              },
              size: "SMALL",
              style: "STANDARD",
              showWhen: ri!activeStep &lt;&gt; length(
                ri!steps
              ),
              validate: true
            ),
            #"SYSTEM_SYSRULES_ButtonWidget"(
              label: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[3],
              submit: true(),
              value: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[3],
              saveInto: {
                if(
                  or(
                    ri!activeStep &gt; 1
                  ),
                  {},
                  a!save(
                    ri!activeStep,
                    ri!activeStep + 1
                  )
                ),
                ri!ButtonAction,
                a!save(
                  ri!fileEntityMapping,
                  append(
                    ri!fileEntityMapping,
                    ri!selectedFileEntityMapping
                  )
                ),
                a!save(
                  ri!sheetFieldMapping,
                  append(
                    ri!sheetFieldMapping,
                    ri!selectedSheetFieldMapping
                  )
                ),
                a!save(
                  ri!sheetFieldMapping,
                  union(
                    ri!sheetFieldMapping,
                    ri!sheetFieldMapping
                  )
                ),
                a!save(
                  ri!sheetFixedCellsConfig,
                  append(
                    ri!sheetFixedCellsConfig,
                    ri!selectedSheetFixedCellsConfig
                  )
                ),
                a!save(
                  ri!sheetFixedCellsConfig,
                  union(
                    ri!sheetFixedCellsConfig,
                    ri!sheetFixedCellsConfig
                  )
                ),
                a!save(
                  ri!refProcessSheetTransposeConfig,
                  append(
                    ri!refProcessSheetTransposeConfig,
                    ri!selectedRefProcessSheetTransposeConfig
                  )
                ),
                a!save(
                  ri!refProcessSheetTransposeConfig,
                  union(
                    ri!refProcessSheetTransposeConfig,
                    ri!refProcessSheetTransposeConfig
                  )
                )
              },
              size: "SMALL",
              style: "STANDARD",
              showWhen: ri!activeStep &lt;&gt; length(
                ri!steps
              ),
              validate: true
            )
          },
          secondaryButtons: {}
        )
      )
    }
  )
}</definition>
        <namedTypedValue>
            <name>steps</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>activeStep</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedStep</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>isReadOnly</name>
            <type>
                <name>boolean</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>masterLookUpData</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>fileEntityMapping</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>sheetFieldMapping</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>refProcessSheetTransposeConfig</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedCard</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>ButtonAction</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>entitySteps</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>entityActiveStep</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>entitySelectedStep</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedEntityCard</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>fileTypeConfig</name>
            <type>
                <name>EAP_T_RefProcessInFileType?list</name>
                <namespace>urn:com:appian:types:eap</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedFileType</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>uniqueIdentifiers</name>
            <type>
                <name>EAP_Temp_ParsingUniqueIdentifiers</name>
                <namespace>urn:com:appian:types:EAP</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>sheetFixedCellsConfig</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>entityData</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedSheetFieldMapping</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedFileEntityMapping</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>navigationIndex</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedSheetFixedCellsConfig</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>selectedRefProcessSheetTransposeConfig</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>parserTypes</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>isFileTabClicked</name>
            <type>
                <name>boolean</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>runtimeConfigs</name>
            <type>
                <name>Text?list</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>columns</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>allTableColumns</name>
            <type>
                <name>Variant</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>editDynamicConfig</name>
            <type>
                <name>boolean</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>dynamicConfig</name>
            <type>
                <name>EAP_T_PR_DYNAMIC_CONF?list</name>
                <namespace>urn:com:appian:types:eap</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>dynamicConfigDetails</name>
            <type>
                <name>EAP_T_PR_DYNAMIC_CONF_DETAIL?list</name>
                <namespace>urn:com:appian:types:eap</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>editConfig</name>
            <type>
                <name>boolean</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
        <isCustom>false</isCustom>
        <customDisplayName></customDisplayName>
    </interface>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name/>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">{
  #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12673"[3],
  #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12673"[4]
}</a:value>
                    <a:nameRef>steps</a:nameRef>
                    <a:id>1</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">2</a:value>
                    <a:nameRef>activeStep</a:nameRef>
                    <a:id>2</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string">Process Field Mapping</a:value>
                    <a:nameRef>selectedStep</a:nameRef>
                    <a:id>3</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:boolean">false</a:value>
                    <a:nameRef>isReadOnly</a:nameRef>
                    <a:id>4</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>masterLookUpData</a:nameRef>
                    <a:id>5</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>fileEntityMapping</a:nameRef>
                    <a:id>6</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>sheetFieldMapping</a:nameRef>
                    <a:id>7</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>refProcessSheetTransposeConfig</a:nameRef>
                    <a:id>8</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>selectedCard</a:nameRef>
                    <a:id>9</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>ButtonAction</a:nameRef>
                    <a:id>10</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">{
  #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12673"[3],
  #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12673"[4]
}</a:value>
                    <a:nameRef>entitySteps</a:nameRef>
                    <a:id>11</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">1</a:value>
                    <a:nameRef>entityActiveStep</a:nameRef>
                    <a:id>12</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>entitySelectedStep</a:nameRef>
                    <a:id>13</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>selectedEntityCard</a:nameRef>
                    <a:id>14</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>fileTypeConfig</a:nameRef>
                    <a:id>15</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>selectedFileType</a:nameRef>
                    <a:id>16</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>uniqueIdentifiers</a:nameRef>
                    <a:id>17</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>sheetFixedCellsConfig</a:nameRef>
                    <a:id>18</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>entityData</a:nameRef>
                    <a:id>19</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>selectedSheetFieldMapping</a:nameRef>
                    <a:id>20</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>selectedFileEntityMapping</a:nameRef>
                    <a:id>21</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:int">0</a:value>
                    <a:nameRef>navigationIndex</a:nameRef>
                    <a:id>22</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>selectedSheetFixedCellsConfig</a:nameRef>
                    <a:id>23</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>selectedRefProcessSheetTransposeConfig</a:nameRef>
                    <a:id>24</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>parserTypes</a:nameRef>
                    <a:id>25</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:boolean"/>
                    <a:nameRef>isFileTabClicked</a:nameRef>
                    <a:id>26</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>runtimeConfigs</a:nameRef>
                    <a:id>27</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>columns</a:nameRef>
                    <a:id>28</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>allTableColumns</a:nameRef>
                    <a:id>29</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:boolean"/>
                    <a:nameRef>editDynamicConfig</a:nameRef>
                    <a:id>30</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>dynamicConfig</a:nameRef>
                    <a:id>31</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>dynamicConfigDetails</a:nameRef>
                    <a:id>32</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:boolean"/>
                    <a:nameRef>editConfig</a:nameRef>
                    <a:id>33</a:id>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000eb24-8f3b-8000-9beb-011c48011c48_260287"/>
    </history>
</contentHaul>
