<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000ed19-51a4-8000-9c01-011c48011c48_381080</versionUuid>
    <interface>
        <name>EAP_uiInputFileUpload</name>
        <uuid>_a-0000e4c6-e892-8000-5254-1bef901bef90_22225</uuid>
        <description>Interface to allows user to do the file upload</description>
        <parentUuid>_a-0000e4c3-7a1b-8000-524f-1bef901bef90_6580</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>load(
  local!fileType: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_7456"(processId: ri!requestDetails.processId),
  local!allUsers: getallusers(1, - 1),
  local!processDetails: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_12194"(processId: ri!requestDetails.processId),
  local!refMasterLookupDetails: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_7827"(type: "WORKFLOW_STATUS", isActive: 1),
  local!inputFile: #"SYSTEM_SYSRULES_forEach"(
    items: ri!refInt,
    expression: {
      'type!{urn:com:appian:types:EAP}EAP_U_ManualUploadAttachmentData'(
        requestId: ri!requestDetails.requestId,
        configId: fv!item.config_id,
        processTransId: index(
          ri!processTransData,
          wherecontains(
            fv!item.config_id,
            tointeger(
              index(ri!processTransData, "configId", null)
            )
          ),
          "transactionId",
          null
        ),
        appianDocumentId: null,
        documentName: fv!item.config_data_name &amp; "-" &amp; tostring(
          index(
            index(
              local!fileType,
              wherecontains(
                tointeger(index(fv!item, "config_id", {})),
                tointeger(index(local!fileType, "config_id", {}))
              ),
              {}
            ),
            "file_config_name",
            {}
          )
        ),
        isOptional: fv!item.is_optional
      )
    }
  ),
  #"SYSTEM_SYSRULES_formLayout_v1"(
    label: "Input File Upload - " &amp; text(today(), "MMM yyyy") &amp; " | " &amp; index(ri!requestDetails, "requestId", null),
    contents: {
      #"SYSTEM_SYSRULES_cardLayout"(
        contents: {
          #"SYSTEM_SYSRULES_columnsLayout"(
            columns: {
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: {
                  #"SYSTEM_SYSRULES_sideBySideLayout"(
                    items: {
                      #"SYSTEM_SYSRULES_sideBySideItem"(
                        item: #"SYSTEM_SYSRULES_richTextDisplayField"(
                          value: {
                            #"SYSTEM_SYSRULES_richTextIcon"(
                              icon: "hashtag",
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[1],
                              size: "LARGE"
                            )
                          }
                        ),
                        width: "MINIMIZE"
                      ),
                      #"SYSTEM_SYSRULES_sideBySideItem"(
                        item: #"SYSTEM_SYSRULES_richTextDisplayField"(
                          value: {
                            #"SYSTEM_SYSRULES_richTextItem_v1"(
                              text: "Process #",
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[1],
                              style: "STRONG"
                            ),
                            char(10),
                            #"SYSTEM_SYSRULES_richTextItem_v1"(
                              text: ri!requestDetails.processId,
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[12]
                            )
                          }
                        ),
                        width: "AUTO"
                      )
                    },
                    alignVertical: "MIDDLE"
                  )
                }
              ),
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: {
                  #"SYSTEM_SYSRULES_sideBySideLayout"(
                    items: {
                      #"SYSTEM_SYSRULES_sideBySideItem"(
                        item: #"SYSTEM_SYSRULES_richTextDisplayField"(
                          value: {
                            #"SYSTEM_SYSRULES_richTextIcon"(
                              icon: "info-circle",
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[1],
                              size: "LARGE"
                            )
                          }
                        ),
                        width: "MINIMIZE"
                      ),
                      #"SYSTEM_SYSRULES_sideBySideItem"(
                        item: #"SYSTEM_SYSRULES_richTextDisplayField"(
                          value: {
                            #"SYSTEM_SYSRULES_richTextItem_v1"(
                              text: "Status",
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[1],
                              style: "STRONG"
                            ),
                            char(10),
                            #"SYSTEM_SYSRULES_richTextItem_v1"(
                              text: if(
                                #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                                  index(
                                    ri!requestDetails,
                                    "requestCurrStatus",
                                    {}
                                  )
                                ),
                                "N/A",
                                index(
                                  index(
                                    local!refMasterLookupDetails,
                                    wherecontains(
                                      touniformstring(
                                        index(
                                          ri!requestDetails,
                                          "requestCurrStatus",
                                          {}
                                        )
                                      ),
                                      touniformstring(
                                        index(local!refMasterLookupDetails, "code", {})
                                      )
                                    ),
                                    {}
                                  ),
                                  "label",
                                  {}
                                )
                              )
                            )
                          }
                        ),
                        width: "AUTO"
                      )
                    },
                    alignVertical: "MIDDLE"
                  )
                }
              ),
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: {
                  #"SYSTEM_SYSRULES_sideBySideLayout"(
                    items: {
                      #"SYSTEM_SYSRULES_sideBySideItem"(
                        item: #"SYSTEM_SYSRULES_richTextDisplayField"(
                          value: {
                            #"SYSTEM_SYSRULES_richTextIcon"(
                              icon: "user-circle",
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[1],
                              size: "LARGE"
                            )
                          }
                        ),
                        width: "MINIMIZE"
                      ),
                      #"SYSTEM_SYSRULES_sideBySideItem"(
                        item: #"SYSTEM_SYSRULES_richTextDisplayField"(
                          value: {
                            #"SYSTEM_SYSRULES_richTextItem_v1"(
                              text: "Maker",
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[1],
                              style: "STRONG"
                            ),
                            char(10),
                            #"SYSTEM_SYSRULES_richTextItem_v1"(
                              text: if(
                                #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(index(ri!requestDetails, "makerId", {})),
                                concat(
                                  user(loggedInUser(), "firstName"),
                                  " ",
                                  user(loggedInUser(), "lastName"),
                                  " (",
                                  loggedInUser(),
                                  ")"
                                ),
                                #"SYSTEM_SYSRULES_forEach"(
                                  items: index(ri!requestDetails, "makerId", {}),
                                  expression: if(
                                    contains(local!allUsers, touser(fv!item)),
                                    concat(
                                      user(fv!item, "firstName"),
                                      " ",
                                      user(fv!item, "lastName"),
                                      " (",
                                      fv!item,
                                      ")"
                                    ),
                                    fv!item
                                  )
                                )
                              )
                            )
                          }
                        ),
                        width: "AUTO"
                      )
                    },
                    alignVertical: "MIDDLE"
                  )
                }
              ),
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: {
                  #"SYSTEM_SYSRULES_sideBySideLayout"(
                    items: {
                      #"SYSTEM_SYSRULES_sideBySideItem"(
                        item: #"SYSTEM_SYSRULES_richTextDisplayField"(
                          value: {
                            #"SYSTEM_SYSRULES_richTextIcon"(
                              icon: "clock-o",
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[1],
                              size: "LARGE"
                            )
                          }
                        ),
                        width: "MINIMIZE"
                      ),
                      #"SYSTEM_SYSRULES_sideBySideItem"(
                        item: #"SYSTEM_SYSRULES_richTextDisplayField"(
                          value: {
                            #"SYSTEM_SYSRULES_richTextItem_v1"(
                              text: "Is Adhoc Trigger",
                              color: #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3236865"[1],
                              style: "STRONG"
                            ),
                            char(10),
                            if(
                              tointeger(
                                index(ri!requestDetails, "isAdhocTrigger")
                              ) = 1,
                              #"SYSTEM_SYSRULES_richTextIcon"(
                                icon: "check-circle",
                                caption: "Yes",
                                color: "POSITIVE",
                                size: "MEDIUM"
                              ),
                              #"SYSTEM_SYSRULES_richTextIcon"(
                                icon: "times-circle",
                                caption: "No",
                                color: "NEGATIVE",
                                size: "MEDIUM"
                              )
                            )
                          }
                        ),
                        width: "AUTO"
                      )
                    },
                    alignVertical: "MIDDLE"
                  )
                }
              )
            },
            marginBelow: "STANDARD"
          )
        },
        height: "AUTO",
        style: "#D6DBDF",
        showBorder: false()
      ),
      #"SYSTEM_SYSRULES_richTextDisplayField"(value: { #"SYSTEM_SYSRULES_richTextItem_v1"(text: char(10)) }),
      #"SYSTEM_SYSRULES_sectionLayout_v1"(
        label: "Process Details",
        contents: {
          #"SYSTEM_SYSRULES_columnsLayout"(
            columns: {
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: #"SYSTEM_SYSRULES_textField"(
                  label: "EUC Refrence Number",
                  value: index(
                    local!processDetails,
                    "euc_reference_number",
                    {}
                  ),
                  readOnly: true()
                )
              ),
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: #"SYSTEM_SYSRULES_textField"(
                  label: "Process Name",
                  value: index(local!processDetails, "name", {}),
                  readOnly: true()
                )
              ),
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: #"SYSTEM_SYSRULES_textField"(
                  label: "Description",
                  value: index(local!processDetails, "description", {}),
                  readOnly: true()
                )
              ),
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: {
                  #"SYSTEM_SYSRULES_radioButtonField_v1"(
                    choiceLabels: { "Yes", "No" },
                    choiceValues: { 1, 0 },
                    label: "Is MultiCurrency",
                    labelPosition: "ABOVE",
                    value: if(
                      a!isNullOrEmpty(ri!requestDetails.isMultiCurrency),
                      0,
                      1
                    ),
                    saveInto: ri!requestDetails.isMultiCurrency,
                    choiceLayout: "COMPACT"
                  )
                }
              )
            }
          )
        }
      ),
      #"SYSTEM_SYSRULES_sectionLayout_v1"(
        label: "Document Details",
        contents: {
          #"SYSTEM_SYSRULES_forEach"(
            items: local!inputFile,
            expression: {
              #"SYSTEM_SYSRULES_columnsLayout"(
                columns: {
                  #"SYSTEM_SYSRULES_columnLayout"(
                    contents: {
                      #"SYSTEM_SYSRULES_radioButtonField"(
                        label: "Use Prior Data?",
                        helpTooltip: if(
                          or(fv!item.isOptional),
                          "Static input file as this IO config is marked as optional",
                          "Mandatory input file as this IO config is marked as not optional"
                        ),
                        choiceLabels: { "Yes", "No" },
                        choiceValues: { 1, 0 },
                        value: if(
                          #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(
                            index(
                              index(
                                ri!processTransData,
                                wherecontains(
                                  tointeger(index(fv!item, "configId", {})),
                                  tointeger(
                                    index(ri!processTransData, "configId", null)
                                  )
                                ),
                                {}
                              ),
                              "usePriorData",
                              null
                            )
                          ),
                          null,
                          tointeger(
                            index(
                              index(
                                ri!processTransData,
                                wherecontains(
                                  tointeger(index(fv!item, "configId", {})),
                                  tointeger(
                                    index(ri!processTransData, "configId", null)
                                  )
                                ),
                                {}
                              ),
                              "usePriorData",
                              null
                            )
                          )
                        ),
                        saveInto: {
                          a!save(
                            ri!processTransData[wherecontains(
                              tointeger(index(fv!item, "configId", {})), tointeger(
                                index(ri!processTransData, "configId", null)
                              )
                            )].usePriorData,
                            save!value
                          ),
                          a!save(fv!item.appianDocumentId, null)
                        },
                        showWhen: if(or(fv!item.isOptional), true(), false()),
                        required: if(or(fv!item.isOptional), true(), false()),
                        disabled: if(or(fv!item.isOptional), false(), true()),
                        choiceLayout: "COMPACT"
                      )
                    }
                  ),
                  #"SYSTEM_SYSRULES_columnLayout"(
                    contents: {
                      #"SYSTEM_SYSRULES_fileUploadField_v1"(
                        label: "Upload " &amp; fv!item.documentName,
                        helpTooltip: "Please upload the file with given config data name-file config name",
                        target: #"_a-0000e4c6-e892-8000-5254-1bef901bef90_22231",
                        maxSelections: 1,
                        value: index(fv!item, "appianDocumentId", null),
                        saveInto: {
                          a!save(fv!item.appianDocumentId, save!value)
                        },
                        required: if(
                          or(
                            index(
                              index(
                                ri!processTransData,
                                wherecontains(
                                  tointeger(index(fv!item, "configId", {})),
                                  tointeger(
                                    index(ri!processTransData, "configId", null)
                                  )
                                ),
                                {}
                              ),
                              "usePriorData",
                              null
                            )
                          ),
                          false(),
                          if(fv!item.isoptional, false(), true())
                        ),
                        disabled: if(
                          tointeger(
                            index(
                              index(
                                ri!processTransData,
                                wherecontains(
                                  tointeger(index(fv!item, "configId", {})),
                                  tointeger(
                                    index(ri!processTransData, "configId", null)
                                  )
                                ),
                                {}
                              ),
                              "usePriorData",
                              null
                            )
                          ) = 0,
                          false(),
                          fv!item.isoptional
                        ),
                        validations: if(
                          #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(fv!item.appianDocumentId),
                          null,
                          if(
                            fv!files.extension = tostring(
                              index(
                                index(
                                  local!fileType,
                                  wherecontains(
                                    tointeger(index(fv!item, "configId", {})),
                                    tointeger(index(local!fileType, "config_id", {}))
                                  ),
                                  {}
                                ),
                                "file_type",
                                {}
                              )
                            ),
                            if(
                              find(
                                tostring(
                                  index(
                                    index(
                                      local!fileType,
                                      wherecontains(
                                        tointeger(index(fv!item, "configId", {})),
                                        tointeger(index(local!fileType, "config_id", {}))
                                      ),
                                      {}
                                    ),
                                    "file_config_name",
                                    {}
                                  )
                                ),
                                fv!files.name
                              ) &gt; 0,
                              null,
                              "The document name should contains- " &amp; tostring(
                                index(
                                  index(
                                    local!fileType,
                                    wherecontains(
                                      tointeger(index(fv!item, "configId", {})),
                                      tointeger(index(local!fileType, "config_id", {}))
                                    ),
                                    {}
                                  ),
                                  "file_config_name",
                                  {}
                                )
                              )
                            ),
                            "The document should be of file type- " &amp; tostring(
                              index(
                                index(
                                  local!fileType,
                                  wherecontains(
                                    tointeger(index(fv!item, "configId", {})),
                                    tointeger(index(local!fileType, "config_id", {}))
                                  ),
                                  {}
                                ),
                                "file_type",
                                {}
                              )
                            )
                          )
                        )
                      )
                    }
                  ),
                  #"SYSTEM_SYSRULES_columnLayout"(contents: {}),
                  #"SYSTEM_SYSRULES_columnLayout"(contents: {})
                }
              )
            }
          )
        }
      )
    },
    buttons: #"SYSTEM_SYSRULES_ButtonLayout"(
      primaryButtons: {
        #"SYSTEM_SYSRULES_ButtonWidget"(
          label: "Submit",
          style: "PRIMARY",
          confirmMessage: "Are you sure want to Submit?",
          submit: true,
          value: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[1],
          saveInto: {
            ri!buttonAction,
            a!save(
              ri!combinedAttachmentData,
              local!inputFile
            ),
            a!save(
              ri!requestDetails.makerId,
              loggedInUser()
            ),
            a!save(
              ri!requestDetails.updatedBy,
              loggedInUser()
            ),
            a!save(ri!requestDetails.updatedOn, now())
          }
        )
      },
      secondaryButtons: {
        #"SYSTEM_SYSRULES_ButtonWidget"(
          label: "Cancel",
          style: "DESTRUCTIVE",
          confirmMessage: "Are you sure want to Cancel?",
          submit: true,
          validate: false(),
          value: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[2],
          saveInto: { ri!buttonAction },
          size: "SMALL"
        ),
        #"SYSTEM_SYSRULES_ButtonWidget"(
          label: "Close",
          submit: true,
          validate: false(),
          value: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[6],
          saveInto: { ri!buttonAction },
          size: "SMALL"
        )
      }
    )
  )
)</definition>
        <namedTypedValue>
            <name>requestDetails</name>
            <type>
                <name>EAP_T_ProcessRequest</name>
                <namespace>urn:com:appian:types:EAP</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>processTransData</name>
            <type>
                <name>EAP_T_ProcessIntTrans?list</name>
                <namespace>urn:com:appian:types:EAP</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>combinedAttachmentData</name>
            <type>
                <name>EAP_U_ManualUploadAttachmentData?list</name>
                <namespace>urn:com:appian:types:EAP</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>refInt</name>
            <type>
                <name>EAP_T_Int?list</name>
                <namespace>urn:com:appian:types:eap</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>buttonAction</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
        <isCustom>false</isCustom>
    </interface>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name/>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">'type!{urn:com:appian:types:EAP}EAP_T_ProcessRequest'(
  requestId:1,
  processId:1
)</a:value>
                    <a:nameRef>requestDetails</a:nameRef>
                    <a:id>1</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">#"SYSTEM_SYSRULES_forEach"(
  items: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_7456"(
    processId:126
  ),
  expression: {
    'type!{urn:com:appian:types:EAP}EAP_T_ProcessIntTrans'(
      transactionId:fv!index,
      requestId:1,

      configId:index(fv!item,"config_id",{}),
      usePriorData:null
    )
  }
)
</a:value>
                    <a:nameRef>processTransData</a:nameRef>
                    <a:id>2</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">null</a:value>
                    <a:nameRef>combinedAttachmentData</a:nameRef>
                    <a:id>3</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">#"_a-0000e4c3-ab68-8000-5250-1bef901bef90_7456"(
  processId:126
)</a:value>
                    <a:nameRef>refInt</a:nameRef>
                    <a:id>4</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>buttonAction</a:nameRef>
                    <a:id>5</a:id>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000e4c6-e892-8000-5254-1bef901bef90_47707"/>
        <historyInfo versionUuid="_a-0000e4cd-1af4-8000-5255-1bef901bef90_93964"/>
        <historyInfo versionUuid="_a-0000e4cd-1af4-8000-5255-1bef901bef90_192318"/>
        <historyInfo versionUuid="_a-0000e505-ae05-8000-525c-1bef901bef90_426674"/>
        <historyInfo versionUuid="_a-0000e518-940a-8000-525e-1bef901bef90_507172"/>
        <historyInfo versionUuid="_a-0000e518-940a-8000-525e-1bef901bef90_519701"/>
        <historyInfo versionUuid="_a-0000e518-940a-8000-525e-1bef901bef90_537263"/>
        <historyInfo versionUuid="_a-0000e53b-d719-8000-d91f-a7ef90a7ef90_3768423"/>
        <historyInfo versionUuid="_a-0000e54c-ce50-8000-5260-1bef901bef90_563246"/>
        <historyInfo versionUuid="_a-0000e595-3324-8000-5263-1bef901bef90_736853"/>
        <historyInfo versionUuid="_a-0000e5c3-a65f-8000-5268-1bef901bef90_771476"/>
        <historyInfo versionUuid="_a-0000e5c3-a65f-8000-5268-1bef901bef90_773466"/>
        <historyInfo versionUuid="_a-0000ed19-51a4-8000-9c01-011c48011c48_381080"/>
    </history>
</contentHaul>
