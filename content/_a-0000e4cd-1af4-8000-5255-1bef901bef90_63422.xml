<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000e4e9-ef8d-8000-5259-1bef901bef90_376301</versionUuid>
    <interface>
        <name>EAP_ManageCalendar</name>
        <uuid>_a-0000e4cd-1af4-8000-5255-1bef901bef90_63422</uuid>
        <description>master interface to Manage eap calander</description>
        <parentUuid>_a-0000e4c3-7a1b-8000-524f-1bef901bef90_6580</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>a!localVariables(
  
  local!viewCal: 0,  
  local!labelAdd: 0,
  local!masterLookup: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_7827"(
    type: {
      #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_108148"[17],
      #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_108743"[2]
    }
  ),
  local!CalendarName,
  local!Region: index(
    local!masterLookup,
    wherecontains(
      "REGION",
      touniformstring(
        index(
          local!masterLookup,
          "type",
          {}
        )
      )
    ),
    {}
  ),
  local!activeStep: 0,
  /*
  local!convertHoursIntoMinute: if(
    rule!EAP_Utils_CheckIsNull(
      ri!hour
    ),
    {},
    ri!hour * 60
  ),
  local!totalMinutes: if(
    or(
      rule!EAP_Utils_CheckIsNull(
        ri!minute
      ),
      ri!minute = 0
    ),
    local!convertHoursIntoMinute,
    sum(
      local!convertHoursIntoMinute,
      ri!minute
    )
  ),
  */
  local!addcal: false(),
  local!nonWorkingDays: {
    is_active: 1
  },
  local!runConfigSubCluster: {
    is_active: 1
  },
  local!data: #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_125209"( isActive: 1    
  ),
  local!regionName : union(index(local!data,"region_name",{}),index(local!data,"region_name",{})),
  /*local!countryName:union(index(local!data,"country_name",{}),index(local!data,"country_name",{})),*/
  with(
    local!data1: #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_125209"(
      /*isActive: 1,*/
      regionName: ri!regionName,
      countryName: ri!countryName,
      SearchCalendarName :local!CalendarName,
      pagingInfo: #"SYSTEM_SYSRULES_pagingInfo"(
        startIndex: 1,
        batchSize: -1,
        sort: #"SYSTEM_SYSRULES_sortInfo"(
          field: "created_on",
          ascending: false()
        )
      )
    ),
    local!countryName: if(
      #"_a-0000e4b2-6487-8000-2b63-01ef9001ef90_3233095"(ri!regionName),
      union(index(local!data,"country_name",{}),index(local!data,"country_name",{})),
      union(
        index(
          index(
            local!data,
            wherecontains(
              ri!regionName,
              touniformstring(index(local!data,"region_name",{}))
            ),
            {}
          ),
          "country_name",
          {}
        ),
        index(
          index(
            local!data,
            wherecontains(
              ri!regionName,
              touniformstring(index(local!data,"region_name",{}))
            ),
            {}
          ),
          "country_name",
          {}
        )
      )
    ),
    
    {
      /*a!paragraphField(value: local!cn),*/

      #"SYSTEM_SYSRULES_sectionLayout_v1"(
        label: "Calendar Country Details",
        contents: {
          #"SYSTEM_SYSRULES_columnsLayout"(
            columns: {
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: #"_a-0000e4e9-ef8d-8000-5259-1bef901bef90_285963"(
                  label: "Calendar Name",
                  labelPosition: "ABOVE",
                  placeHolder: "Calendar Name",
                  refreshAfter: "KEYPRESS",
                  value: local!CalendarName,
                  saveInto: local!CalendarName
                )
              ),
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: {
                  #"_a-0000e4e9-ef8d-8000-5259-1bef901bef90_287171"(
                    label:"Region Name",
                    labelPosition: "ABOVE",
                    placeholderLabel: "---select Region---",
                    choiceLabels: local!regionName,
                    choiceValues:  local!regionName,                  
                    value: ri!regionName,
                    saveInto: {
                      ri!regionName
                      ,
                      a!save(
                        ri!countryName,
                        null
                      )
                    }
                  )
                }
              ),
              #"SYSTEM_SYSRULES_columnLayout"(
                contents: {
                  #"_a-0000e4e9-ef8d-8000-5259-1bef901bef90_287171"(
                    label:"Country Name",
                    labelPosition: "ABOVE",
                    placeholderLabel: "---select Country---",
                    choiceLabels: local!countryName,
                    choiceValues:  local!countryName, 
                    value: ri!countryName,
                    saveInto: ri!countryName
                  )
                }
              ),
             
            }
          ),
          #"SYSTEM_SYSRULES_gridField_v1"(
            data: local!data1,
            columns: {
              #"SYSTEM_SYSRULES_gridColumn"(
                label: "Calendar Name",
                sortField: "calendar_name",
                value: fv!row.calendar_name
              ),
              #"SYSTEM_SYSRULES_gridColumn"(
                label: "Region Name",
                sortField: "region_name",
                value: fv!row.region_name
              ),
              #"SYSTEM_SYSRULES_gridColumn"(
                label: "Country Name",
                sortField: "country_name",
                value: fv!row.country_name
              ),
              #"SYSTEM_SYSRULES_gridColumn"(
                label: "Time Zone",
                sortField: "timezone_id",
                value: fv!row.timezone_id
              ),
              #"SYSTEM_SYSRULES_gridColumn"(
                label: "Start Working Time",
                value: fv!row.start_working_time
              ),
              #"SYSTEM_SYSRULES_gridColumn"(
                label: "End Working Time",
                value: fv!row.end_working_time
              ),
              /*a!gridColumn(*/
              /*label: "Is Active",*/
              /*sortField: "isActive",*/
              /*value: fv!row.isActive,*/
              /*align: "END"*/
              /*),*/
              #"SYSTEM_SYSRULES_gridColumn"(
                label: "Edit",
                value: #"SYSTEM_SYSRULES_richTextDisplayField"(
                  align: "CENTER",
                  value: {
                    #"SYSTEM_SYSRULES_richTextIcon"(
                      icon: "edit",
                      caption: "Edit",
                      color: if(
                        tointeger(
                          local!activeStep
                        ) = 0,
                        "ACCENT",
                        "SECONDARY"
                      ),
                      linkStyle: "STANDALONE",
                      link: if(
                        tointeger(
                          local!activeStep
                        ) = 0,
                        #"SYSTEM_SYSRULES_dynamicLink"(
                          value: 1,
                          saveInto: {
                            local!activeStep,
                            a!save(
                              ri!calendarId,
                              fv!row.calendar_id
                            ),
                            a!save(
                              ri!year,
                              year(today())
                            ),
                            a!save(
                              ri!refCalendarCountryDetails,
                              #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_125209"(
                                calendarId : ri!calendarId
                              )
                            ),
                            a!save(
                              ri!refCalendarExceptionWorkingDay,
                              #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_69112"(
                                calendarId : ri!calendarId
                              )
                            ),
                            a!save(
                              ri!CalendarNonWorkingDay,
                              #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_125445"(
                                calendarId : ri!calendarId
                              )
                            ),
                            a!save(
                              ri!refCalendarHoliday,
                              #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_127093"(
                                calendarId : ri!calendarId
                              )
                            )
                          }
                        ),
                        {}
                      ),
                      size: "MEDIUM_PLUS"
                    ),

                  }
                )
              )
            },
            pageSize: 10
          ),
         /* a!richTextDisplayField(
            value: a!richTextItem(
              text: " View Calendar",
              color: if(
                tointeger(
                  local!viewCal
                ) = 0,
                "ACCENT",
                "SECONDARY"
              ),
              style: "STRONG",
              link: if(
                tointeger(
                  local!viewCal
                ) = 0,
                a!dynamicLink(
                  value: 1,
                  saveInto: {
                    local!viewCal,
                    a!save(
                      local!activeStep,
                      0
                    )
                  }
                ),
                {}
              )
            ),
            showWhen: or(
              tointeger(
                local!viewCal
              ) = 0
            )
          ) */
        },
        showWhen: and(
          tointeger(
            local!activeStep
          ) = 0,
          tointeger(
            local!viewCal
          ) = 0
        )
      ),
      #"SYSTEM_SYSRULES_ButtonLayout"(
        primaryButtons: #"SYSTEM_SYSRULES_ButtonWidget"(
          label: "Add New Details",
          value: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[1],
          saveInto: {
            ri!buttonAction,
            a!save(
              local!addcal,
              true()
            ),
            a!save(
              local!activeStep,
              1
            ),
            a!save(
              local!labelAdd,
              1
            )
          },
          /*submit:true(),*/
          style: "PRIMARY",
          validate: true()
        ),
        secondaryButtons:  #"SYSTEM_SYSRULES_ButtonWidget"(
          label: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[2],
          value: #"_a-0000e4c3-ab68-8000-5250-1bef901bef90_13888"[2],
          saveInto: {
            ri!buttonAction
          },
          
          submit: true()
        ),
        showWhen: and(
          tointeger(
            local!activeStep
          ) = 0,
          tointeger(
            local!viewCal
          ) = 0
        )
      ),
      if(
        or(
          tointeger(
            local!activeStep
          ) = 1
        ),
        #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_93695"(
          buttonAction: ri!buttonAction,
          refCalendarCountryDetails: ri!refCalendarCountryDetails,          
          activeStep: local!activeStep,
          calendarNonWorkingDay: ri!CalendarNonWorkingDay,
          calendarExceptionWorkingDay: ri!refCalendarExceptionWorkingDay,
          labelAdd: local!labelAdd,
          refCalendarHoliday:ri!refCalendarHoliday,
          CalendarId: ri!calendarId,
          year:ri!year,
          isActive: ri!isActive,
          isInactive: ri!isInactive
        ),
        {}
      ),
      if(
        or(
          tointeger(
            local!viewCal
          ) = 1
        ),
        {
          #"_a-0000e4cd-1af4-8000-5255-1bef901bef90_95199"(
            isReadOnly: false(),
            viewCal: local!viewCal
          )
        },
        {}
      )
    }
  )
)</definition>
        <namedTypedValue>
            <name>buttonAction</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>refCalendarCountryDetails</name>
            <type>
                <name>EAP_T_RefCalendarCountryDetails</name>
                <namespace>urn:com:appian:types:eap</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>CalendarNonWorkingDay</name>
            <type>
                <name>EAP_T_RefCalendarNonWorkingDay?list</name>
                <namespace>urn:com:appian:types:eap</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>calendarId</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>refCalendarExceptionWorkingDay</name>
            <type>
                <name>EAP_T_RefCalendarExceptionWorkingDay?list</name>
                <namespace>urn:com:appian:types:eap</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>regionName</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>countryName</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>refCalendarHoliday</name>
            <type>
                <name>EAP_T_RefCalendarHoliday?list</name>
                <namespace>urn:com:appian:types:eap</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>year</name>
            <type>
                <name>int</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>isActive</name>
            <type>
                <name>boolean</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>isInactive</name>
            <type>
                <name>boolean</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
        <isCustom>false</isCustom>
    </interface>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name/>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>buttonAction</a:nameRef>
                    <a:id>1</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="a:Expression">{
  region_name:"",
  country_name:""
}</a:value>
                    <a:nameRef>refCalendarCountryDetails</a:nameRef>
                    <a:id>2</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
                    <a:nameRef>CalendarNonWorkingDay</a:nameRef>
                    <a:id>3</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:int"/>
                    <a:nameRef>calendarId</a:nameRef>
                    <a:id>4</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
                    <a:nameRef>refCalendarExceptionWorkingDay</a:nameRef>
                    <a:id>5</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>regionName</a:nameRef>
                    <a:id>6</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>countryName</a:nameRef>
                    <a:id>7</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
                    <a:nameRef>refCalendarHoliday</a:nameRef>
                    <a:id>8</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:int"/>
                    <a:nameRef>year</a:nameRef>
                    <a:id>9</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:boolean"/>
                    <a:nameRef>isActive</a:nameRef>
                    <a:id>10</a:id>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:boolean"/>
                    <a:nameRef>isInactive</a:nameRef>
                    <a:id>11</a:id>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000e4cd-1af4-8000-5255-1bef901bef90_78521"/>
        <historyInfo versionUuid="_a-0000e4cd-1af4-8000-5255-1bef901bef90_94364"/>
        <historyInfo versionUuid="_a-0000e4cd-1af4-8000-5255-1bef901bef90_98569"/>
        <historyInfo versionUuid="_a-0000e4cd-1af4-8000-5255-1bef901bef90_154796"/>
        <historyInfo versionUuid="_a-0000e4cd-1af4-8000-5255-1bef901bef90_191769"/>
        <historyInfo versionUuid="_a-0000e4dd-0d8b-8000-5257-1bef901bef90_222767"/>
        <historyInfo versionUuid="_a-0000e4e9-ef8d-8000-5259-1bef901bef90_322639"/>
        <historyInfo versionUuid="_a-0000e4e9-ef8d-8000-5259-1bef901bef90_376301"/>
    </history>
</contentHaul>
